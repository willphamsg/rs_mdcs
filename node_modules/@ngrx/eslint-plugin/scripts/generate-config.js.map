{"version":3,"file":"generate-config.js","sourceRoot":"","sources":["../../../../modules/eslint-plugin/scripts/generate-config.ts"],"names":[],"mappings":"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","sourcesContent":["import { writeFileSync } from 'fs';\nimport { join } from 'path';\nimport { format, resolveConfig } from 'prettier';\nimport { rulesForGenerate } from '../src/utils/helper-functions/rules';\nimport { NgRxRule } from '../src/rule-creator';\n\n(async () => {\n  const prettierConfig = await resolveConfig(__dirname);\n  const RULE_MODULE = '@ngrx';\n  const CONFIG_DIRECTORY = './modules/eslint-plugin/src/configs/';\n\n  writeConfig('all', (_rule) => true);\n  writeConfig('store', (rule) => rule.meta.docs?.ngrxModule === 'store');\n  writeConfig('effects', (rule) => rule.meta.docs?.ngrxModule === 'effects');\n  writeConfig(\n    'component-store',\n    (rule) => rule.meta.docs?.ngrxModule === 'component-store'\n  );\n  writeConfig(\n    'operators',\n    (rule) => rule.meta.docs?.ngrxModule === 'operators'\n  );\n  writeConfig('signals', (rule) => rule.meta.docs?.ngrxModule === 'signals');\n\n  async function writeConfig(\n    configName:\n      | 'all'\n      | 'store'\n      | 'effects'\n      | 'component-store'\n      | 'operators'\n      | 'signals',\n    predicate: (rule: NgRxRule) => boolean\n  ) {\n    const rulesForConfig = Object.entries(rulesForGenerate).filter(\n      ([_, rule]) => predicate(rule)\n    );\n    const configRules = rulesForConfig.reduce<Record<string, string>>(\n      (rules, [ruleName, _rule]) => {\n        rules[`${RULE_MODULE}/${ruleName}`] = 'error';\n        return rules;\n      },\n      {}\n    );\n    const requireParserOptions: null | Record<string, string | number> =\n      rulesForConfig.some(([_, rule]) => rule.meta.docs?.requiresTypeChecking)\n        ? {\n            ecmaVersion: 2020,\n            sourceType: 'module',\n            project: './tsconfig.json',\n          }\n        : null;\n\n    const tsCode = `\n      /**\n     * DO NOT EDIT\n     * This file is generated\n     */\n\n      import type { TSESLint } from '@typescript-eslint/utils';\n\n      export default (\n        plugin: TSESLint.FlatConfig.Plugin,\n        parser: TSESLint.FlatConfig.Parser,\n      ): TSESLint.FlatConfig.ConfigArray => [\n        {\n          name: 'ngrx/base',\n          languageOptions: {\n            parser,\n            sourceType: 'module',\n          },\n          plugins: {\n            '@ngrx': plugin,\n          },\n        },\n        {\n          name: 'ngrx/${configName}',\n          languageOptions: {\n            parser,\n            ${\n              requireParserOptions\n                ? `parserOptions: ${JSON.stringify(\n                    requireParserOptions,\n                    null,\n                    2\n                  )},`\n                : ''\n            }\n          },\n          rules: ${JSON.stringify(configRules, null, 2)}\n        },\n      ];`;\n    const tsConfigFormatted = await format(tsCode, {\n      parser: 'typescript',\n      ...prettierConfig,\n    });\n    writeFileSync(\n      join(CONFIG_DIRECTORY, `${configName}.ts`),\n      tsConfigFormatted\n    );\n\n    const jsonConfig: { [key: string]: any } = {\n      parser: '@typescript-eslint/parser',\n      plugins: ['@ngrx'],\n      rules: configRules,\n    };\n    if (requireParserOptions) {\n      jsonConfig.parserOptions = {\n        ecmaVersion: 2020,\n        sourceType: 'module',\n        project: './tsconfig.json',\n      };\n    }\n    const jsonConfigFormatted = await format(\n      JSON.stringify(jsonConfig, null, 2),\n      {\n        parser: 'json',\n        ...prettierConfig,\n      }\n    );\n\n    writeFileSync(\n      join(CONFIG_DIRECTORY, `${configName}.json`),\n      jsonConfigFormatted\n    );\n  }\n})();\n"]}