{"version":3,"file":"generate-overview.js","sourceRoot":"","sources":["../../../../modules/eslint-plugin/scripts/generate-overview.ts"],"names":[],"mappings":"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","sourcesContent":["import { readFileSync, writeFileSync } from 'fs';\nimport { EOL } from 'os';\nimport { format, resolveConfig } from 'prettier';\nimport {\n  configsForGenerate,\n  rulesForGenerate,\n} from '../src/utils/helper-functions/rules';\n\n(async () => {\n  const prettierConfig = await resolveConfig(__dirname);\n  const OVERVIEW = './projects/ngrx.io/content/guide/eslint-plugin/index.md';\n  const GH_CONFIGS =\n    'https://github.com/ngrx/platform/blob/main/modules/eslint-plugin/src/configs';\n\n  await generateRules();\n  await generateConfigurations();\n\n  async function generateRules() {\n    const moduleRules = Object.entries(rulesForGenerate).reduce<\n      Record<string, string[][]>\n    >((all, [ruleName, { meta }]) => {\n      if (!meta.docs) {\n        throw new Error(`Rule ${ruleName} is missing meta.docs information`);\n      }\n\n      all[meta.docs.ngrxModule] = (all[meta.docs.ngrxModule] ?? []).concat([\n        [\n          `[@ngrx/${ruleName}]${\n            meta.docs?.url\n              ? '(' +\n                meta.docs.url\n                  .replace('https://ngrx.io', '')\n                  .replace('.md', '') +\n                ')'\n              : ''\n          }`,\n          meta.docs?.description ?? 'TODO',\n          meta.type,\n          meta.fixable ? 'Yes' : 'No',\n          meta.hasSuggestions ? 'Yes' : 'No',\n          Array.isArray(meta.schema) && meta.schema.length ? 'Yes' : 'No',\n          meta.docs?.requiresTypeChecking ? 'Yes' : 'No',\n        ],\n      ]);\n      return all;\n    }, {});\n\n    const tableHeader = `| Name | Description | Category | Fixable | Has suggestions | Configurable | Requires type information\n| --- | --- | --- | --- | --- | --- | --- |`;\n\n    const configTable = Object.entries(moduleRules).map(\n      ([ngrxModule, pluginRules]) => {\n        const tableBody = pluginRules\n          .map((rule) => `|${rule.join('|')}|`)\n          .join(EOL);\n        const table = [tableHeader, tableBody].join(EOL);\n\n        return [`### ${ngrxModule}`, table].join(EOL);\n      }\n    );\n\n    const overview = readFileSync(OVERVIEW, 'utf-8');\n    const start = overview.indexOf('<!-- RULES-CONFIG:START -->');\n    const end = overview.indexOf('<!-- RULES-CONFIG:END -->');\n\n    const newOverview = await format(\n      `${overview.substring(0, start + '<!-- RULES-CONFIG:START -->'.length)}\n${configTable.join(EOL)}\n${overview.substring(end)}`,\n      {\n        ...prettierConfig,\n        parser: 'markdown',\n      }\n    );\n\n    writeFileSync(OVERVIEW, newOverview);\n  }\n\n  async function generateConfigurations() {\n    const tableHeader = `| Name |\n    | --- |`;\n\n    const overview = readFileSync(OVERVIEW, 'utf-8');\n    const start = overview.indexOf('<!-- CONFIGURATIONS-CONFIG:START -->');\n    const end = overview.indexOf('<!-- CONFIGURATIONS-CONFIG:END -->');\n\n    const configTable = configsForGenerate.map(\n      (configName) => `| [${configName}](${GH_CONFIGS}/${configName}.json) |`\n    );\n    const newOverview = await format(\n      `${overview.substring(\n        0,\n        start + '<!-- CONFIGURATIONS-CONFIG:START -->'.length\n      )}\n${[tableHeader, ...configTable].join(EOL)}\n${overview.substring(end)}`,\n      {\n        ...prettierConfig,\n        parser: 'markdown',\n      }\n    );\n\n    writeFileSync(OVERVIEW, newOverview);\n  }\n})();\n"]}